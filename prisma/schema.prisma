// Prisma schema for MySQL/MariaDB
// Run `npx prisma migrate dev --name init` after editing

datasource db {
  provider = "mysql"
}

generator client {
  provider = "prisma-client-js"
}

model Settings {
  id         Int           @id @default(autoincrement())
  page_id    Int?
  key        String
  value      String
  created_at DateTime      @default(now())
  updated_at DateTime      @default(now())
  @@map("jr_settings")
}

model Project {
  id         Int         @id @default(autoincrement())
  name       String
  short      String
  role       String?
  position   String?
  extended   String?     @db.Text
  created_at DateTime    @default(now())
  updated_at DateTime    @default(now())
  links      ProjectLink[]
  gallery    ProjectGallery[]
  skills     ProjectSkill[]
  categories ProjectCategory[]
  @@map("jr_projects")
}

model ProjectLink {
  id         Int         @id @default(autoincrement())
  project_id Int
  project    Project     @relation(fields: [project_id], references: [id])
  website    String
  url        String
  priority   Int         @default(0)
  created_at DateTime    @default(now())
  updated_at DateTime    @default(now())
  gallery    ProjectGallery[]
  @@map("jr_projects_links")
}

model ProjectGallery {
  id         Int           @id @default(autoincrement())
  project_id Int
  project    Project       @relation(fields: [project_id], references: [id])
  link_id    Int?
  link       ProjectLink?  @relation(fields: [link_id], references: [id])
  title      String
  image      String
  priority   Int           @default(0)
  created_at DateTime      @default(now())
  updated_at DateTime      @default(now())
  @@map("jr_projects_gallery")
}

model ProjectSkill {
  project_id Int
  project    Project       @relation(fields: [project_id], references: [id])
  skill_id   Int
  skill      Skill         @relation(fields: [skill_id], references: [id])
  priority   Int           @default(0)
  created_at DateTime      @default(now())
  updated_at DateTime      @default(now())
  @@id([project_id, skill_id])
  @@map("jr_projects_skills")
}

model ProjectCategory {
  project_id    Int
  project       Project    @relation(fields: [project_id], references: [id])
  category_id   Int
  category      Category   @relation(fields: [category_id], references: [id])
  priority      Int        @default(0)
  created_at    DateTime   @default(now())
  updated_at    DateTime   @default(now())
  @@id([project_id, category_id])
  @@map("jr_projects_cats")
}

model Skill {
  id         Int           @id @default(autoincrement())
  name       String
  desc       String
  rating     Int           @db.TinyInt @default(5)
  created_at DateTime      @default(now())
  updated_at DateTime      @default(now())
  projects   ProjectSkill[]
  @@map("jr_skills")
}

model Category {
  id         Int           @id @default(autoincrement())
  title      String
  created_at DateTime      @default(now())
  updated_at DateTime      @default(now())
  projects   ProjectCategory[]
  @@map("jr_cats")
}